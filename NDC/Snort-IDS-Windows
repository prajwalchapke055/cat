# üîí Snort IDS on Windows ‚Äî Step-by-Step Practical

## üìå **[1Ô∏è‚É£] Show File Extensions (Windows)**

- Open **File Explorer**
- Click the **View** tab
- Check ‚úÖ **File name extensions**
  _(This helps you see `.rules` extensions correctly.)_

---

## üìå **[2Ô∏è‚É£] Exclude Snort Folder in Windows Defender**

- Open **Windows Security**
  ‚ûú Start > Settings > Update & Security > Windows Security > Virus & threat protection
  ‚ûú Manage settings > Exclusions
  ‚ûú Add or remove exclusions
  ‚ûú Add **Folder** ‚ûú Select your `C:\Snort` folder

---

## üìå **[3Ô∏è‚É£] Install Snort & WinPcap**

1Ô∏è‚É£ **Download Snort for Windows** from official site ‚Üí Run installer ‚Üí Default location `C:\Snort` ‚Üí Install as Administrator.
2Ô∏è‚É£ **Download & Install WinPcap** ‚Üí Accept defaults ‚Üí Needed for Snort to capture packets.

---

## üìå **[4Ô∏è‚É£] Explore Snort Directory**

- Open `C:\Snort` in File Explorer.
- Typical folders:

  - **bin/** ‚Üí Snort executables.
  - **etc/** ‚Üí Config files (`snort.conf`).
  - **rules/** ‚Üí IDS rule files.
  - **log/** ‚Üí Logs of alerts.
  - **schemas/** ‚Üí Core config schemas.

üëâ Note these for your viva.

---

## üìå **[5Ô∏è‚É£] Verify Installation**

Open **Command Prompt as Administrator**:

```bash
cd C:\Snort\bin
snort -?
```

Check that Snort runs and shows help.

---

## üìå **[6Ô∏è‚É£] Check Network Interfaces**

```bash
cd C:\Snort\bin
snort -W
```

- Lists your network interfaces.
- Note the interface number you‚Äôll use.
  _(E.g., `1` for Ethernet, `2` for Wi-Fi)_

---

## üìå **[7Ô∏è‚É£] Download & Add Snort Rules**

1Ô∏è‚É£ Download `snortrules-snapshot-xxx.tar.gz` (from Snort website).
2Ô∏è‚É£ Use **7-Zip**:

- Extract to `C:\Snort`
- **Overwrite all** when asked.
- The `rules/` folder should now have \~85 `.rules` files, e.g., `browser-ie.rules`.

---

## üìå **[8Ô∏è‚É£] Basic Windows Network Check**

```bash
getmac /fo csv /v
```

- `/fo csv` ‚Üí format output as CSV
- `/v` ‚Üí verbose (extra details)

---

## üìå **[9Ô∏è‚É£] Fix Common `snort.conf` Errors**

**Open `C:\Snort\etc\snort.conf` in VS Code or Notepad++.**

‚úÖ **ERROR 1 ‚Äî `ipvar`**

```plaintext
Search: ipvar
Replace: var
```

‚úîÔ∏è Replace all.

---

‚úÖ **ERROR 2 ‚Äî `snort_dynamicpreprocessor`**

```plaintext
# Original (Linux path):
dynamicpreprocessor directory /usr/local/lib/snort_dynamicpreprocessor/

# Replace with:
dynamicpreprocessor directory C:\Snort\lib\snort_dynamicpreprocessor

# Example line:
dynamicpreprocessor C:\Snort\lib\snort_dynamicpreprocessor\sf_dce2.dll
```

---

‚úÖ **ERROR 3 ‚Äî `dynamicengine`**

```plaintext
# Original:
dynamicengine /usr/local/lib/snort_dynamicengine/libsf_engine.so

# Replace with:
dynamicengine C:\Snort\lib\snort_dynamicengine\sf_engine.dll
```

---

‚úÖ **ERROR 4 ‚Äî `snort_dynamicrules` folder**

- Make this folder if missing:

  ```plaintext
  C:\Snort\lib\snort_dynamicrules
  ```

---

‚úÖ **ERROR 5 ‚Äî `normalize_ip4`**

- Search:

  ```plaintext
  Step #5: Configure preprocessors
  ```

- **Comment all 5 lines** below it using `#`.

---

‚úÖ **ERROR 6 ‚Äî `white_list.rules`**

- Make an empty file:

  ```plaintext
  C:\Snort\rules\white_list.rules
  ```

‚úÖ **ERROR 7 ‚Äî `black_list.rules`**

- Make an empty file:

  ```plaintext
  C:\Snort\rules\black_list.rules
  ```

---

## üìå **[üîü] Correct `snort.conf` Paths**

‚úîÔ∏è Change rule paths:

```plaintext
var RULE_PATH C:\Snort\rules
var SO_RULE_PATH C:\Snort\so_rules
var PREPROC_RULE_PATH C:\Snort\preproc_rules

var WHITE_LIST_PATH C:\Snort\rules
var BLACK_LIST_PATH C:\Snort\rules

whitelist $WHITE_LIST_PATH\white_list.rules, \
blacklist $BLACK_LIST_PATH\black_list.rules
```

‚úîÔ∏è Fix line 573:

```plaintext
include $RULE_PATH\black_list.rules
```

---

## üìå **[1Ô∏è‚É£1Ô∏è‚É£] Test Snort Config**

Run:

```bash
cd C:\Snort\bin
snort -i 1 -c C:\Snort\etc\snort.conf -l C:\Snort\log -T
```

‚úîÔ∏è `-T` ‚Üí test config
‚úîÔ∏è `-i 1` ‚Üí your interface number

---

## üìå **[1Ô∏è‚É£2Ô∏è‚É£] Write a Custom Rule**

1Ô∏è‚É£ Create:

```plaintext
C:\Snort\rules\myrules.rules
```

Content:

```plaintext
alert ip any any -> any any (msg:"Your Message"; sid:1000001;)
```

2Ô∏è‚É£ Add to `snort.conf`:

```plaintext
include $RULE_PATH\myrules.rules
```

Save.

---

## üìå **[1Ô∏è‚É£3Ô∏è‚É£] Run Snort in IDS Mode**

```bash
cd C:\Snort\bin

# Test config:
snort -i 1 -c C:\Snort\etc\snort.conf -l C:\Snort\log -T

# Run & show alerts in console:
snort -i 1 -c C:\Snort\etc\snort.conf -l C:\Snort\log -A console
```

‚úîÔ∏è `-A console` ‚Üí show alerts live.

---

## ‚úÖ **Result**

üéâ You now have:

- Installed Snort
- Fixed all config errors
- Added official rules + your custom rule
- Ran Snort IDS in live monitoring mode
- Logs saved in `C:\Snort\log`

---
